(function(f){function n(){this.selectors={elems:".js-notification"};this.settings={close_limit:40,translate_limit:50,opacity_limit:.4};this.load()}n.prototype=f.extend({},n.prototype,{load:function(){var c=this,d;$body.on("mousedown",this.selectors.elems,function(a){if("A"!==a.target.tagName&&!f(a.target).parents("[data-js-action]").length){c.is_holded=!0;var b=f(this),e=a.screenX;d=0;b.addClass("animate");setTimeout(function(){b.addClass("pressed")},0);$body.on("mousemove.notification",function(g){d=
Math.min(e+c.settings.translate_limit,Math.max(e-c.settings.translate_limit,g.screenX))-e;b.removeClass("animate");setTimeout(function(){b.css({transform:"translateX("+d+"px) scale(0.95)",opacity:Math.max((c.settings.translate_limit-Math.abs(d))/c.settings.translate_limit,c.settings.opacity_limit)})},0);setTimeout(function(){b.addClass("animate")},0)});$body.one("mouseup.notification",function(){b.trigger("mouseup")});a.preventDefault();return!1}});$body.on("mouseup",this.selectors.elems,function(){var a=
f(this);c.is_holded=!1;$body.unbind("mousemove.notification mouseup.notification");setTimeout(function(){if(Math.abs(d)>c.settings.close_limit){var b=a.find("[data-js-notification-inner]"),e=b.find('[data-js-action="close"]').first();if(b.hasClass("d-none"))return;a.one("transitionend",function(){d=0;a.trigger("mouseup").trigger("transitionend");e.trigger("click");b.trigger("transitionend");a.trigger("onpressedend")});a.css({transform:"translateX("+(d+20)+"px) scale(0.95)",opacity:0})}else a.removeClass("pressed"),
a.one("transitionend",function(){a.removeClass("animate");a.trigger("onpressedend")}),a.css({transform:"",opacity:""});"0s"===a.css("transition-duration")&&a.trigger("transitionend")},0)});$body.on("close",this.selectors.elems,function(){var a=f(this);$body.unbind("mousemove.notification");a.trigger("mouseup").trigger("transitionend")});this._products();this._cookies()},_cookies:function(){function c(){b.one("click",function(){if("true"===g){var h=new Date,l=864E5*k;h.setTime(h.getTime()+l);theme.Cookie.set("notification-cookies",
"off",{expires:h})}d._hide(a,function(){a.remove()});f(this).off()})}var d=this,a=f(".js-notification-cookies");if(a.length){var b=a.find('[data-js-action="close"]');var e=theme.Cookie.get("notification-cookies");var g=a.attr("data-js-show-once");var m=+a.attr("data-js-delay");var k=+a.attr("data-js-cookies-life");"off"!==e&&(0<m?setTimeout(function(){d._show(a,function(){c()})},1E3*m):c());return b}},_products:function(){function c(){a._hide(b,function(){d()})}function d(){clearInterval(p);if(!b.hasClass("d-none")||
a.is_holded)if(a.is_holded)b.parents(".js-notification").one("onpressedend",function(){c()});else if(b.is(":hover"))b.one("mouseleave",function(){c()});else c();else q=g.eq(Math.round(-.5+Math.random()*(g.length-1+1))),r=Math.round(k-.5+Math.random()*(h-k+1)),g.addClass("d-none"),q.removeClass("d-none"),a._show(b,function(){t=setTimeout(function(){d()},1E3*r);0!==l&&(p=setTimeout(function(){a._hide(b)},1E3*l))},function(u){u()})}var a=this,b=f(".js-notification-products");if(b.length){var e=b.find('[data-js-action="close"]'),
g=b.find("[data-js-notification-products-item]"),m=+b.attr("data-js-delay"),k=+b.attr("data-js-interval-min"),h=+b.attr("data-js-interval-max"),l=+b.attr("data-js-max-time-life"),q,r,p,t;setTimeout(function(){d()},1E3*m);e.on("click",function(){clearTimeout(t);a._hide(b)});return e}},_show:function(c,d,a){function b(){setTimeout(function(){c.addClass("visible")},0);"0s"===c.css("transition-duration")&&c.trigger("transitionend")}c.unbind("transitionend");if(d)c.one("transitionend",function(){d()});
c.removeClass("d-none");c.addClass("animate");a?a(b):b()},_hide:function(c,d){c.unbind("transitionend");c.one("transitionend",function(){c.addClass("d-none").removeClass("animate").removeAttr("style");c.parents(".js-notification").trigger("close");d&&d()});c.removeClass("visible");"0s"===c.css("transition-duration")&&c.trigger("transitionend")},destroy:function(){f(".js-notification-cookies, .js-notification-products").find('[data-js-action="close"]').off()}});theme.AssetsLoader.onPageLoaded(function(){theme.Notifications=
new n})})(jQueryTheme);
