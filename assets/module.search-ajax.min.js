(function(b){function p(){this.settings={default_search_obj:{url:theme.routes.search_url,data:{view:"json"}},suggest_search_obj:{url:theme.routes.search_url+"/suggest.json",data:{resources:{type:theme.search_show_only_products?"product":"product,page",unavailable_products:"last",fields:"title,vendor,product_type,variants.title",options:null}}}};this.selectors={search:".js-search-ajax"};this.load()}p.prototype=b.extend({},p.prototype,{load:function(){function v(a,c,d){if(0<d.count){var e=b(b("#template-search-ajax")[0].content),
f=b(document.createDocumentFragment()),h=+a.attr("data-js-max-products")-1;b.each(d.results,function(q){var k=e.clone(),m=k.find(".product-search-2__image img"),w=k.find(".product-search-2__title a"),r=k.find(".product-search-2__price .price");k.find("a").attr("href",this.url);w.html(this.title);this.image?m.attr("srcset",Shopify.resizeImage(this.image,"200x")+" 1x, "+Shopify.resizeImage(this.image,"200x@2x")+" 2x"):m.remove();if(r.length)if(this.price){switch(theme.search_result_correction){case "/100":this.price/=
100;this.compare_at_price/=100;break;case "/10":this.price/=10;this.compare_at_price/=10;break;case "*10":this.price*=10;this.compare_at_price*=10;break;case "*100":this.price*=100,this.compare_at_price*=100}theme.ProductPrice.insert(r,this.price,this.compare_at_price)}else r.remove();f.append(k);return q<h});c.html("");c.append(f);theme.LazyImage.update();theme.MultiCurrency&&theme.MultiCurrency.update()}else c.html("");c[0<d.count?"removeClass":"addClass"]("d-none-important")}function n(a,c,d,e){var f=
a.find(".search-ajax__result"),h=a.find(".search-ajax__view-all"),q=h.find("a"),k=a.find(".search-ajax__empty");q.attr("href",theme.routes.search_url+"?q="+d+"&options[prefix]=last"+(theme.search_show_only_products?"&type=product":""));h[0<e.count?"removeClass":"addClass"]("d-none-important");k.html(theme.strings.general.search.no_results_html.replace("{{ terms }}",d))[""===d||0<e.count?"addClass":"removeClass"]("d-none-important");f.addClass("invisible");v(a,f,e);f.removeClass("invisible");theme.Preloader.unset(c);
a.find('button[type="submit"]').removeClass("disabled");a.addClass("open");$body.unbind("click.search-ajax");$window.unbind("scroll.search-ajax");$body.on("click.search-ajax",function(m){b(m.target).parents(".js-search-ajax").length||(t(),$body.unbind("click.search-ajax"))});$window.on("scroll.search-ajax",function(){t();$window.unbind("scroll.search-ajax")})}function t(a){a=a||b(l.selectors.search);var c=a.find(".search-ajax__content");g="";a.find("input").val("");n(a,c,g,{count:0});a.removeClass("open")}
var l=this,g="",u;$body.on("keyup",this.selectors.search+" input",theme.debounce(function(a){var c=b(a.target).parents(l.selectors.search);if(27!==a.keyCode){a=b(a.target).val().replace(/<script[^>]*>(?:(?!<\/script>)[^])*<\/script>/g,"").trim();var d=c.find(".search-ajax__content");a!==g&&(g=a,""===g?n(c,d,g,{count:0}):(u&&u.abort(),theme.Preloader.set(d),c.find('button[type="submit"]').addClass("disabled"),u=b.getJSON(b.extend(!0,{},theme.search_predictive_enabled?l.settings.suggest_search_obj:
l.settings.default_search_obj,{type:"GET",data:{q:g},success:function(e){var f={count:Math.min(e.resources.results.products.length+(e.resources.results.pages?e.resources.results.pages.length:0),5),results:[]},h=0;b.each(e.resources.results.products,function(){if(5<h)return!1;theme.search_predictive_enabled&&-1===this.price_min.indexOf(".")&&(this.price_min*=100);theme.search_predictive_enabled&&-1===this.compare_at_price_min.indexOf(".")&&(this.compare_at_price_min*=100);f.results.push({price:this.price_min,
compare_at_price:this.compare_at_price_min,image:this.image,title:this.title,url:this.url});h++});b.each(e.resources.results.pages,function(){if(5<h)return!1;f.results.push({title:this.title,url:this.url,image:this.image||null});h++});n(c,d,g,f)}}))))}},500));$body.on("keyup",this.selectors.search+" input",function(a){if(27===a.keyCode){a=b(this).parents(l.selectors.search);var c=a.find(".search-ajax__content");g="";n(a,c,g,{count:0})}});$body.on("clear",this.selectors.search,function(){t(b(this))})},
closeAll:function(){b(this.selectors.search+".open").trigger("clear")}});theme.AssetsLoader.onPageLoaded(function(){theme.SearchAjax=new p})})(jQueryTheme);
