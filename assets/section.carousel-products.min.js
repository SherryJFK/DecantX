(function(f){class g extends HTMLElement{constructor(){super();this.settings={arrows:!0};setTimeout(()=>{theme.AssetsLoader.onScrollOrUserAction(this,()=>{this.load()})},0)}load(){this.$container=f(this);var a=this,c=this.$container.find(".product-recommendations"),b,e;theme.AssetsLoader.loadManually([["styles","plugin_slick"],["scripts","plugin_slick"]],function(){c.length?(b=c.attr("data-product-id"),e=c.attr("data-limit"),f.ajax({type:"GET",url:theme.routes.root_url+"recommendations/products",
data:{section_id:c.parents("[data-section-id]").attr("data-section-id"),product_id:b,limit:e},success:function(d){d=d.replace(/<carousel-products/g,"<div").replace(/<\/carousel-products/g,"</div");c.html(f(d).find(".product-recommendations").html());a.initCarousel();theme.LazyImage.update();theme.MultiCurrency&&theme.MultiCurrency.update();theme.Tooltip&&theme.Tooltip.init()}})):a.initCarousel()})}initCarousel(){var a=this;this.$slick=this.$container.find("[data-js-carousel-slick]");if(this.$slick.length){this.$slider=
this.$container.find("[data-js-carousel]");this.$collections_ajax=this.$container.find("[data-carousel-ajax] [data-collection]");this.$products=this.$container.find("[data-carousel-items]");this.$slides=this.$slick.find("> *");this.$prev=this.$slider.find("[data-js-carousel-prev]");this.$next=this.$slider.find("[data-js-carousel-next]");this.$arrows=this.$slider.find("[data-js-carousel-arrow]");this.$control=this.$container.find("[data-carousel-control]");this.settings.arrows="true"===this.$slider.attr("data-arrows")?
!0:!1;this.settings.bullets="true"===this.$slider.attr("data-bullets")?!0:!1;this.settings.count=+this.$slider.attr("data-count");this.settings.infinite="true"===this.$slider.attr("data-infinite")?!0:!1;this.settings.autoplay="true"===this.$slider.attr("data-autoplay")?!0:!1;this.settings.speed=+this.$slider.attr("data-speed")||0;if(this.settings.arrows)$window.on("theme.resize.carousel-products",function(){a.arrowsPosition()});this.$collections_ajax.length?this.loadProducts(this.$collections_ajax.first()):
this.initSlick();this.$control.on("click","a",function(c){var b=f(this);b.hasClass("active")||a.loadProducts(b,!0);c.preventDefault();return!1})}}arrowsPosition(){var a=0;this.$slick.find(".carousel__item img").each(function(){a=Math.max(a,f(this).innerHeight())});this.$arrows.css({top:a/2});this.$prev.add(this.$next).css({"max-height":a})}initSlick(){var a=this;this.$slick.one("init",function(){a.settings.arrows&&a.arrowsPosition();$window.trigger("checkImages");a.$slider.removeClass("invisible");
theme.Preloader.unset(a.$slider.parent())});this.$slick.on("beforeChange",function(c,b,e,d){c=d+a.settings.count;a._checkProduct(a.$slick.find('[data-slick-index="'+(d-1)+'"]'));for(d=c;d>e+1;d--)a._checkProduct(a.$slick.find('[data-slick-index="'+d+'"]'))});this.$slick.on("afterChange",function(){theme.Tooltip&&theme.Tooltip.init()});this.$slick.one("init",function(){a.$slider.addClass("initialized")});this.$slick.slick({lazyLoad:!1,arrows:this.settings.arrows,prevArrow:this.$prev,nextArrow:this.$next,
dots:this.settings.bullets,dotsClass:"slick-dots d-flex flex-wrap flex-center list-unstyled pt-7",adaptiveHeight:!0,autoplay:this.settings.autoplay,autoplaySpeed:this.settings.speed,infinite:this.settings.infinite,slidesToShow:this.settings.count,slidesToScroll:this.settings.count,touchMove:!1,rtl:theme.rtl,responsive:[{breakpoint:theme.breakpoints.values.xl,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:theme.breakpoints.values.md,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:theme.breakpoints.values.sm,
settings:{slidesToShow:2,slidesToScroll:2}}]})}loadProducts(a,c){this.xhr&&this.xhr.abort();var b=this;c&&(theme.Preloader.set(this.$slider.parent()),this.$slider.css({"min-height":this.$slider.innerHeight()}));var e=a.attr("data-collection");this.xhr=f.ajax({type:"GET",url:theme.routes.root_url+"collections/"+e,cache:!1,data:{view:"carousel",max_count:this.$products.attr("data-max-count"),size_of_columns:this.$products.attr("data-products-pre-row"),async_ajax_loading:this.$products.attr("data-async-ajax-loading")},
dataType:"html",success:function(d){b.$slider.addClass("invisible");b.$slick.hasClass("slick-initialized")&&b.$slick.slick("destroy").off();b.$slick.one("init",function(){b.$slider.removeAttr("style");c&&theme.Preloader.unset(b.$slider.parent())});b.$products.html(d);b.$slides=b.$slick.find("> *");b.initSlick();theme.LazyImage.update();theme.MultiCurrency&&theme.MultiCurrency.update();theme.Tooltip&&theme.Tooltip.init();b.$control.find("a").removeClass("active");a.addClass("active");b.xhr=null}})}_checkProduct(a,
c){var b=this,e=a.attr("data-handle");return e?(c&&c(a),f.ajax({type:"GET",url:theme.routes.root_url+"products/"+e,data:{view:"collection"},cache:!1,dataType:"html",success:function(d){d=f(d);a.add(b.$slick.find('.slick-cloned[data-handle="'+e+'"]')).html(d).removeAttr("data-handle");theme.LazyImage.update();a.trigger("loaded")}}),!0):!1}disconnectedCallback(){this.$slick&&(this.$slick.slick("destroy").off(),this.$slick=null,$window.unbind("theme.resize.carousel-products"));this.$control.off()}}theme.AssetsLoader.onPageLoaded(function(){customElements.define("carousel-products",
g)})})(jQueryTheme);
